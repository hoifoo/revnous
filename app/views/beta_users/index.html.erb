<%= render "shared/notice_banner" %>

<!-- Hero Section -->
<div class="bg-gradient-to-br from-gray-900 via-purple-900 to-pink-900 text-white py-20">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
    <h1 class="text-5xl lg:text-6xl font-bold mb-6">Become a Beta User</h1>
    <p class="text-xl text-gray-300 max-w-2xl mx-auto">
      Get early access to our latest features and help shape the future of our products. Join our beta program today!
    </p>
  </div>
</div>

<!-- Beta Signup Section -->
<div class="bg-white py-20">
  <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Benefits Section -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
      <div class="text-center p-6 bg-gray-50 rounded-lg">
        <div class="w-16 h-16 bg-pink-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-pink-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
          </svg>
        </div>
        <h3 class="text-lg font-semibold text-gray-900 mb-2">Early Access</h3>
        <p class="text-gray-600">Be the first to try new features before they're publicly released</p>
      </div>

      <div class="text-center p-6 bg-gray-50 rounded-lg">
        <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"/>
          </svg>
        </div>
        <h3 class="text-lg font-semibold text-gray-900 mb-2">Direct Feedback</h3>
        <p class="text-gray-600">Your input directly influences product development and improvements</p>
      </div>

      <div class="text-center p-6 bg-gray-50 rounded-lg">
        <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/>
          </svg>
        </div>
        <h3 class="text-lg font-semibold text-gray-900 mb-2">Exclusive Perks</h3>
        <p class="text-gray-600">Special discounts and benefits for beta program participants</p>
      </div>
    </div>

    <!-- Signup Form -->
    <div class="bg-gray-50 rounded-2xl p-8 md:p-12 shadow-lg">
      <h2 class="text-3xl font-bold text-gray-900 mb-6 text-center">Join Our Beta Program</h2>

      <%= form_with url: beta_signup_path, method: :post, scope: :beta_user, class: "space-y-6", id: "beta-signup-form" do |form| %>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <%= form.label :name, "Your Name", class: "block text-sm font-medium text-gray-700 mb-2" %>
            <%= form.text_field :name, required: true, class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent text-lg", placeholder: "John Doe" %>
          </div>

          <div>
            <%= form.label :email, "Email Address", class: "block text-sm font-medium text-gray-700 mb-2" %>
            <%= form.email_field :email, required: true, class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent text-lg", placeholder: "john@example.com" %>
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div>
            <%= form.label :company, "Company Name (Optional)", class: "block text-sm font-medium text-gray-700 mb-2" %>
            <%= form.text_field :company, class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent text-lg", placeholder: "Your Company" %>
          </div>

          <div>
            <%= form.label :website, "Website (Optional)", class: "block text-sm font-medium text-gray-700 mb-2" %>
            <%= form.url_field :website, class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent text-lg", placeholder: "https://yourwebsite.com" %>
          </div>
        </div>

        <div>
          <%= form.label :store_link, "Store Link (Optional)", class: "block text-sm font-medium text-gray-700 mb-2" %>
          <%= form.url_field :store_link, class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent text-lg", placeholder: "https://yourstore.com" %>
        </div>

        <% if @product.present? %>
          <!-- Product is pre-selected via product-scoped route -->
          <%= form.hidden_field :product_id, value: @product.id %>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Product</label>
            <div class="w-full px-4 py-3 border border-gray-200 rounded-lg bg-gray-100 text-lg text-gray-700">
              <%= @product.name %>
            </div>
          </div>
        <% else %>
          <!-- Show product dropdown for generic beta signup -->
          <div>
            <%= form.label :product_id, "Product", class: "block text-sm font-medium text-gray-700 mb-2" %>
            <%= form.select :product_id,
                options_from_collection_for_select(@products, :id, :name),
                { prompt: "Select a product" },
                { required: true, class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent text-lg" } %>
          </div>
        <% end %>

        <div>
          <%= form.label :message, "Additional Information (Optional)", class: "block text-sm font-medium text-gray-700 mb-2" %>
          <%= form.text_area :message, rows: 6, class: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-transparent text-lg", placeholder: "Tell us about your use case, specific features you're interested in, or any questions you have..." %>
        </div>

        <!-- ALTCHA CAPTCHA Widget -->
        <div class="flex justify-center">
          <altcha-widget
            challengeurl="<%= altcha_challenge_path %>"
            hidelogo="false"
            name="altcha"
          ></altcha-widget>
        </div>

        <div class="text-center">
          <%= form.submit "Join Beta Program", class: "px-12 py-4 bg-pink-600 text-white text-lg font-semibold rounded-lg hover:bg-pink-700 transition cursor-pointer shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-pink-600", id: "submit-btn", disabled: true %>
        </div>
      <% end %>
    </div>

    <!-- ALTCHA Widget Script (now bundled in application.js) -->
    <script>
      // Wait for custom element to be defined
      if (customElements && customElements.whenDefined) {
        customElements.whenDefined('altcha-widget').then(() => {
          console.log('ALTCHA widget is ready');
          setupAltchaListener();
        });
      } else {
        // Fallback for older browsers
        document.addEventListener('DOMContentLoaded', setupAltchaListener);
      }

      function setupAltchaListener() {
        const submitBtn = document.getElementById('submit-btn');
        const altchaWidget = document.querySelector('altcha-widget');

        console.log('Setting up ALTCHA listener');
        console.log('Submit button:', submitBtn);
        console.log('ALTCHA widget:', altchaWidget);

        if (!submitBtn) {
          console.error('Submit button not found!');
          return;
        }

        if (!altchaWidget) {
          console.error('ALTCHA widget not found!');
          return;
        }

        // Listen for ALTCHA verification events
        altchaWidget.addEventListener('statechange', (event) => {
          console.log('ALTCHA state changed:', event.detail);

          // Enable button when ALTCHA is verified
          if (event.detail.state === 'verified') {
            console.log('ALTCHA verified - enabling button');
            submitBtn.disabled = false;
            submitBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            submitBtn.classList.add('cursor-pointer');
          } else {
            console.log('ALTCHA not verified - disabling button');
            submitBtn.disabled = true;
            submitBtn.classList.add('opacity-50', 'cursor-not-allowed');
            submitBtn.classList.remove('cursor-pointer');
          }
        });

        console.log('ALTCHA listener attached successfully');
      }
    </script>
  </div>
</div>

<!-- FAQ Section -->
<div class="bg-gray-50 py-16">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
    <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center">Frequently Asked Questions</h2>

    <div class="space-y-6">
      <div class="bg-white rounded-lg p-6 shadow-sm">
        <h3 class="text-lg font-semibold text-gray-900 mb-2">What does it mean to be a beta user?</h3>
        <p class="text-gray-600">As a beta user, you'll get early access to new features and updates before they're released to the general public. You'll have the opportunity to test, provide feedback, and help shape the product development.</p>
      </div>

      <div class="bg-white rounded-lg p-6 shadow-sm">
        <h3 class="text-lg font-semibold text-gray-900 mb-2">Is there any cost to join the beta program?</h3>
        <p class="text-gray-600">No, joining our beta program is completely free. In fact, beta users often receive exclusive discounts and perks as a thank you for their valuable feedback.</p>
      </div>

      <div class="bg-white rounded-lg p-6 shadow-sm">
        <h3 class="text-lg font-semibold text-gray-900 mb-2">How will I be notified about beta features?</h3>
        <p class="text-gray-600">We'll send you email updates when new beta features are available. You'll also have direct access to our product team for support and feedback.</p>
      </div>

      <div class="bg-white rounded-lg p-6 shadow-sm">
        <h3 class="text-lg font-semibold text-gray-900 mb-2">Can I leave the beta program anytime?</h3>
        <p class="text-gray-600">Absolutely! You can leave the beta program at any time by contacting us at <%= link_to "contact@revnous.com", "mailto:contact@revnous.com", class: "text-pink-600 hover:text-pink-700 underline" %>.</p>
      </div>
    </div>
  </div>
</div>

<!-- CTA Section -->
<div class="bg-gradient-to-br from-pink-600 to-purple-700 py-16">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
    <h2 class="text-4xl font-bold text-white mb-4">Questions About Our Beta Program?</h2>
    <p class="text-xl text-white mb-8">
      Our team is here to help. Contact us for more information.
    </p>
    <div class="flex justify-center gap-4">
      <%= link_to contact_us_path, class: "px-8 py-4 bg-black text-white rounded-md hover:bg-gray-900 transition font-medium text-lg" do %>
        Contact Us
      <% end %>
      <%= link_to products_path, class: "px-8 py-4 bg-white text-gray-900 rounded-md hover:bg-gray-100 transition font-medium text-lg" do %>
        View Products
      <% end %>
    </div>
  </div>
</div>
